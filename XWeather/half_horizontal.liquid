<style>
  .weather-icon {
    width: 7rem;
    height: 7rem;
    object-fit: contain;
  }
  
  .main-icon {
    width: 7rem;
    height: 7rem;
  }
  
  .weather-icon-container {
    width: 100%;
    max-width: 200px;
  }

  /* Main Layout Container */
  .weather-display {
    width: 100%;
    max-width: 750px;
    display: flex;
    flex-direction: column;
    font-family: system-ui, -apple-system, sans-serif;
    padding-right:1rem;
    padding-top:1rem;
    gap: 0rem; /* Reduced gap */
  }

  /* Header Section */
  .header-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .location-block .location-title {
    font-size: 1.5rem;
    font-weight: bold;
    margin-left: 1rem;
    line-height: 1; 
  }

  .location-block .update-time {
    font-size: 1rem;
    font-weight: bold;
    margin-left: 1rem;
  }


  /* Temperature Display */
  .temp-section {
    display: flex;
    align-items: center;
    gap: .5rem; /* Reduced gap */
  }

  .main-temp {
    font-size: 4rem;
    font-weight: bold;
    line-height: 1;
    text-align: right;
  }

  .feels-like-temp {
    font-size: 1rem;
    font-weight: bold;
    display: block;
  }

  /* Weather Stats Grid */
  .stats-container {
    /* margin-top: 0; */
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    margin-bottom:1.5rem
  }

  /* Individual Stat Item */
  .stat-item {
    display: flex;
    align-items: center;
    gap: 1rem; /* Reduced gap */
    background: transparent;
    padding: .25rem;
  }

  .stat-icon {
    width: 3rem;
    height: 3rem;
    flex-shrink: 0;
  }

  .stat-content {
    display: flex;
    flex-direction: column;
  }

  .stat-title {
    font-size: 1.25rem;
    font-weight: bold;
    white-space: nowrap;
    line-height: 1;
  }

  .stat-number {
    font-size: 1.25rem;
    font-weight: bold;
    line-height: 1.1; /* Tighter line height */
  }

  .stat-time {
    font-size: 1rem;
    font-weight: bold;
    line-height: 1.1; 
  }

  .stat-unit {
    font-size: .75rem;
    font-weight: bold;
    margin-left: 0.25rem;
  }

  .stat-sub {
    font-size: .7rem;
    font-weight: bold;
    margin-top: 0; /* Reduced margin */
    line-height: 1;
  }

</style>

{%- if response -%}
<div class="layout">
  <div class="weather-display">
    <!-- Header with Location and Main Temperature -->
    <div class="header-section">
      <div class="location-block">
        <!-- <h1 class="location-title">{{ location_name | default: "My Weather Station" }}</h1> -->
        <h1 class="location-title">{{ trmnl.plugin_settings.custom_fields_values.location_name | default: "My Weather Station"}}</h1>
        <p class="update-time text--gray-30">Updated: &nbsp; {{- response.ob.timestamp | date: "%s" | plus: trmnl.user.utc_offset | date: "%b %d, %Y, %I:%M %p" -}}</p>
      </div>

      <div class="temp-section">
        <div class="main-icon {{ icon_class }}">
          <img src="{{ icon_url }}" alt="{{ response.ob.weather }}" class="weather-icon">
        </div>
        <div class="main-temp">
          {%- if system == "metric" -%}
            {{- response.ob.tempC | round -}}&deg;
            <span class="feels-like-temp text--gray-30">Feels like {{ response.ob.feelslikeC | round }}&deg;</span>
          {%- else -%}
            {{- response.ob.tempF | round -}}&deg;
            <span class="feels-like-temp text--gray-30">Feels like {{ response.ob.feelslikeF | round }}&deg;</span>
          {%- endif -%}
        </div>
      </div>
    </div>

    <!-- Weather Statistics Grid -->
    <div class="stats-container">

      <!-- Wind Speed and Direction -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}" style="{{ wind_rotation }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_wind_deg }}" /></svg>
        </div>
        <div class="stat-content">
          <div class="stat-title text--gray-30">Wind ({{- response.ob.windDir -}})</div>
          {%- if system == "metric" -%}
            <div class="stat-number">{{- response.ob.windSpeedKPH | round -}}<span class="stat-unit text--gray-30">kph</span></div>
            {%- if response.ob.windGustKPH -%}
              <div class="stat-sub text--gray-30">Gusts to {{ response.ob.windGustKPH | round }} kph</div>
            {%- endif -%}
          {%- else -%}
            <div class="stat-number">{{- response.ob.windSpeedMPH | round -}}<span class="stat-unit text--gray-30">mph</span></div>
            {%- if response.ob.windGustMPH -%}
              <div class="stat-sub text--gray-30">Gusts to {{ response.ob.windGustMPH | round }} mph</div>
            {%- endif -%}
          {%- endif -%}
        </div>
      </div>

      <!-- Humidity with Dewpoint -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_humidity }}" /></svg>
        </div>
        <div class="stat-content">
          <div class="stat-title text--gray-30">Humidity</div>
          <div class="stat-number">{{- response.ob.humidity -}}<span class="stat-unit text--gray-30">%</span></div>
          {%- if system == "metric" -%}
            <div class="stat-sub text--gray-30">Dewpoint: {{ response.ob.dewpointC | round }}&deg;C</div>
          {%- else -%}
            <div class="stat-sub text--gray-30">Dewpoint: {{ response.ob.dewpointF | round }}&deg;F</div>
          {%- endif -%}
        </div>
      </div>

      <!-- Barometric Pressure -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_barometer }}" /></svg>
        </div>
        <div class="stat-content">
          <div class="stat-title text--gray-30">Pressure</div>
          {%- if system == "metric" -%}
            <div class="stat-number">{{- response.ob.pressureMB | round -}}<span class="stat-unit text--gray-30">hPa</span></div>
          {%- else -%}
            <div class="stat-number">{{- response.ob.pressureIN | round: 2 -}}<span class="stat-unit text--gray-30">inHg</span></div>
          {%- endif -%}
        </div>
      </div>

      <!-- Daily Precipitation -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_showers }}" /></svg>
        </div>
        <div class="stat-content">
          <div class="stat-title text--gray-30">Precipitation</div>
          {%- if system == "metric" -%}
            <div class="stat-number">{{- response.ob.precipMM | default: 0.0 | round: 1 -}}<span class="stat-unit text--gray-30">mm</span></div>
            {%- else -%}
            <div class="stat-number">{{- response.ob.precipIN | default: 0.0 | round: 2 -}}<span class="stat-unit text--gray-30">in</span></div>
          {%- endif -%}
        </div>
      </div>

      <!-- UV Index -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_hot }}" /></svg>
        </div>
        <div class="stat-content">
          <div class="stat-title text--gray-30">UV Index</div>
          <div class="stat-number">{{- response.ob.uvi | default: response.ob.uv | default: 0 -}}</div>
        </div>
      </div>
  
      <!-- Sunrise/Sunset Times -->
      <div class="stat-item">
        <div class="stat-icon {{ icon_class }}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" fill="currentColor"><path d="{{ icon_horizon_alt }}" /></svg>
        </div>
        <div class="stat-content">
          <span class="stat-title text--gray-30">Rise: <span class="stat-time"> {{ response.ob.sunrise | date: "%s" | plus: trmnl.user.utc_offset | date: "%I:%M %p" }}</span></span>
          <span class="stat-title text--gray-30">Set: <span class="stat-time"> {{ response.ob.sunset | date: "%s" | plus: trmnl.user.utc_offset | date: "%I:%M %p" }}</span></span>
        </div>
      </div>

    </div>
  </div>  
</div>
{%- endif -%}
